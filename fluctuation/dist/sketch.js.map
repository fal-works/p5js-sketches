{"version":3,"file":"sketch.js","sources":["../src/common.ts","../src/settings.ts","../src/shape.ts","../src/sketch.ts","../src/main.ts"],"sourcesContent":["/**\n * ---- Common ----------------------------------------------------------------\n */\n\nimport p5 from \"p5\";\nimport * as CCC from \"@fal-works/creative-coding-core\";\nimport * as p5ex from \"@fal-works/p5-extension\";\n\nexport const { Random } = CCC;\n\nexport const { onSetup, onInstantiate } = p5ex;\n\n/**\n * Shared p5 instance.\n */\nexport let p: p5;\n\nonInstantiate.push((p5Instance) => {\n  p = p5Instance;\n});\n\n/**\n * Shared canvas instance.\n */\nexport let canvas: p5ex.ScaledCanvas;\n\n/**\n * Alias for `p.drawingContext`.\n */\nexport let context: CanvasRenderingContext2D;\n\nonSetup.push(() => {\n  canvas = p5ex.canvas;\n  context = (p as any).drawingContext; // eslint-disable-line\n});\n\nexport const resetCommon = () => {};\n","/**\n * ---- Settings --------------------------------------------------------------\n */\n\n/** The id of the HTML element to which the canvas should belong. */\nexport const HTML_ELEMENT_ID = \"Fluctuation\";\n\n/** The logical width of the canvas. */\nexport const LOGICAL_CANVAS_WIDTH = 720;\n\n/** The logical height of the canvas. */\nexport const LOGICAL_CANVAS_HEIGHT = 720;\n","import { onSetup, p } from \"@fal-works/p5-extension\";\n\nimport p5 from \"p5\";\n\nconst SIZE = 180;\nconst NOISE_SCALE = 0.0075;\nconst MIN_TIME_SCALE = 0.02;\nconst TIME_SCALE_DECAY = 0.92;\nlet time = 1000 * Math.random();\nlet timeScale = MIN_TIME_SCALE;\nlet g: p5.Graphics;\n\nexport const impact = () => {\n  timeScale = 0.2;\n};\n\nexport const update = () => {\n  g.clear();\n  g.noStroke();\n  g.fill(255, 32);\n\n  const w = g.width;\n  const h = g.height;\n\n  const startX = 0.25 * w;\n  const startY = 0.25 * h;\n  const endX = 0.75 * w;\n  const endY = 0.75 * h;\n\n  for (let x = startX; x < endX; x += 1) {\n    for (let y = startY; y < endY; y += 1) {\n      const offsetMag = 0.5 * SIZE;\n      const noiseFactor =\n        p.noise(time + NOISE_SCALE * x) + p.noise(-time + NOISE_SCALE * y) - 1;\n      const radius = offsetMag * noiseFactor;\n      const angle = 2 * Math.PI * noiseFactor;\n\n      g.circle(x + radius * Math.cos(angle), y + radius * Math.sin(angle), 4);\n    }\n  }\n\n  time += timeScale;\n  timeScale = Math.max(MIN_TIME_SCALE, timeScale * TIME_SCALE_DECAY);\n};\n\nonSetup.push(() => {\n  g = p.createGraphics(SIZE, SIZE);\n  update();\n});\n\nexport const draw = () => {\n  p.imageMode(p.CENTER);\n  const adjust = -0.1 * SIZE;\n  p.image(g, adjust, adjust);\n};\n","/**\n * ---- Sketch ----------------------------------------------------------------\n */\n\nimport { pauseOrResume } from \"@fal-works/p5-extension\";\nimport { p, canvas } from \"./common\";\nimport * as Shape from \"./shape\";\n\n// ---- reset & initialize ----\nconst drawSketch = (): void => {\n  const { width, height } = canvas.logicalSize;\n\n  const resolution = 3;\n  const intervalX = width / (resolution + 1);\n  const intervalY = height / (resolution + 1);\n  for (let x = 1; x <= resolution; x += 1) {\n    for (let y = 1; y <= resolution; y += 1) {\n      p.push();\n      p.translate(x * intervalX, y * intervalY);\n      Shape.draw();\n      p.pop();\n    }\n  }\n};\n\nexport const reset = (): void => {};\n\nexport const initialize = (): void => {\n  p.imageMode(p.CENTER);\n\n  reset();\n};\n\nconst draw = () => {\n  Shape.update();\n\n  p.background(0);\n  canvas.drawScaled(drawSketch);\n};\n\n// ---- UI ----\n\nconst mousePressed = () => Shape.impact();\n\nconst keyTyped = () => {\n  switch (p.key) {\n    case \"p\":\n      pauseOrResume();\n      break;\n    case \"g\":\n      p.save(\"image.png\");\n      break;\n    case \"r\":\n      reset();\n      break;\n  }\n\n  return false;\n};\n\n// ---- p5 methods ----\n\nexport const p5Methods = {\n  keyTyped,\n  mousePressed,\n  draw,\n};\n","/**\n * ---- Main ------------------------------------------------------------------\n */\n\nimport { startSketch } from \"@fal-works/p5-extension\";\n\nimport { canvas } from \"./common\";\nimport * as Settings from \"./settings\";\nimport * as sketch from \"./sketch\";\n\n// ---- start sketch ----\n\nstartSketch({\n  htmlElement: Settings.HTML_ELEMENT_ID,\n  logicalCanvasWidth: Settings.LOGICAL_CANVAS_WIDTH,\n  logicalCanvasHeight: Settings.LOGICAL_CANVAS_HEIGHT,\n  initialize: sketch.initialize, // delete?\n  windowResized: () => canvas.resizeIfNeeded(),\n  onCanvasResized: sketch.reset,\n  p5Methods: sketch.p5Methods,\n});\n"],"names":["p5ex","p5ex.canvas","p","onSetup","Shape.draw","draw","Shape.update","Shape.impact","pauseOrResume","startSketch","Settings.HTML_ELEMENT_ID","Settings.LOGICAL_CANVAS_WIDTH","Settings.LOGICAL_CANVAS_HEIGHT","sketch.initialize","sketch.reset","sketch.p5Methods"],"mappings":"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"}