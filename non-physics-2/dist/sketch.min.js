/**
 * Non-Physics 2.
 * Source code in TypeScript: https://github.com/fal-works/p5js-sketches/tree/master/non-physics-2
 *
 * @copyright 2020 FAL
 * @version 0.1.0
 */
!function(e,t){"use strict";const{Numeric:{lerp:o,square:r},ArrayList:a,HSV:s,Random:n,Easing:i,Angle:{QUARTER_PI:c},Timer:l,Timer:{Set:d},Arrays:h}=t,{onSetup:u,onInstantiate:p,translate:g,undoTranslate:w,drawTransformed:v,ShapeColor:f}=e;let y,b,C;p.push(e=>{y=e}),u.push(()=>{b=e.canvas,C=y.drawingContext});const S=()=>{const e=n.between(40,90),t=n.between(40,90);return()=>y.rect(0,0,e,t)},m=()=>{const e=n.between(40,80);switch(n.Integer.value(4)){case 0:return()=>y.triangle(0,0,0,e,e,e);case 1:return()=>y.triangle(0,0,e,0,0,e);case 2:return()=>y.triangle(0,0,e,0,e,e);case 3:return()=>y.triangle(0,e,e,e,e,0);default:throw"Unexpected value."}},x=(e,t)=>{const{x:o,y:r,clockwise:a,color:s,drawShape:n}=e;f.apply(s,255*t);const i=(a?1:-1)*t*4*Math.PI;v(n,o,r,i,t)};let k,I,P,R;e.onSetup.push(()=>{k=e.ShapeColor.create("#3232FF",void 0,256),I=e.ShapeColor.create("#B72DE5",void 0,256),P=e.ShapeColor.create("#20D84E",void 0,256),R=e.ShapeColor.create("#D8D820",void 0,256)});const T=()=>{const e=n.bool(.7)?[k,I]:[P,R],t=[];for(let i=0;i<3;i+=1)t.push((o=n.signed(30),r=n.signed(30),a=n.bool(.5),s=n.Arrays.get(e),{x:o,y:r,clockwise:a,color:s,drawShape:Math.random()<.5?S():m()}));var o,r,a,s;return t},z=e=>{g(e.x,e.y);for(const t of e.units)x(t,e.visibility);w()};let A;const E=d.create(64);let O=[];const D=(e,t)=>{const o=((e,t)=>({x:e,y:t,units:T(),visibility:0}))(e,t);O.push(o);const r=l.create({duration:60,onProgress:e=>{const t=e.ratio,r=i.Out.expo(t);o.visibility=r}}),a=l.create({duration:n.Integer.between(60,180)}),s=l.create({duration:60,onProgress:e=>{const t=e.ratio,r=i.In.expo(t);o.visibility=1-r},onComplete:()=>{O.splice(O.indexOf(o),1),D(e,t)}}),c=l.chain([r,a,s]);d.add(E,c)},F=()=>{y.background(252),A=e.storePixels(),(()=>{O=[],d.clear(E);const{width:e,height:t}=b.logicalSize;for(let o=e/20;o<e;o+=e/5)for(let e=t/20;e<t;e+=t/5)D(o,e)})()},M=()=>{for(const e of O)z(e)},N={draw:()=>{d.step(E),A(),b.drawScaled(M)},keyTyped:()=>{switch(y.key){case"p":e.pauseOrResume();break;case"g":y.save("image.png");break;case"r":F()}return!1}};e.startSketch({htmlElement:"NonPhysics2",logicalCanvasWidth:800,logicalCanvasHeight:800,initialize:()=>{F(),y.strokeWeight(2),y.noFill();const{scaleFactor:e}=b;C.shadowOffsetX=3*e,C.shadowOffsetY=3*e,C.shadowBlur=12*e,C.shadowColor="rgba(0, 0, 0, 0.3)"},windowResized:()=>b.resizeIfNeeded(),onCanvasResized:F,p5Methods:N})}(p5ex,CreativeCodingCore);