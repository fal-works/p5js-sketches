/**
 * Layers.
 * Source code in TypeScript: https://github.com/fal-works/p5js-sketches/tree/master/layers
 *
 * @copyright 2020 FAL
 * @version 0.1.0
 */
!function(e,t,a){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}const o=r(e),i=n(a),{onSetup:h,onInstantiate:c}=o;let s,d;c.push((e=>{s=e})),h.push((()=>{d=e.canvas}));const l=(e,t,a,n,r)=>{let o;switch(r){case 0:o={x:e,y:t,width:a,height:0};break;case 1:o={x:e,y:t,width:0,height:n}}const h=i.default.lch(95,120,360*Math.random()).rgb();return{bounds:o,targetBounds:{x:e,y:t,width:a,height:n},color:s.color(h[0],h[1],h[2]),alpha:1,targetAlpha:160,type:r}},u=.05,g=e=>{const{bounds:t,targetBounds:a,type:n}=e;if(t.x+=u*(a.x-t.x),t.y+=u*(a.y-t.y),t.width+=u*(a.width-t.width),t.height+=u*(a.height-t.height),e.alpha+=u*(e.targetAlpha-e.alpha),159<e.alpha){switch(n){case 0:a.y=t.y+t.height,a.height=0;break;case 1:a.x=t.x+t.width,a.width=0}e.targetAlpha=0}return 1<=e.alpha},p=t=>{const{bounds:a,color:n,alpha:r}=t;s.fill(e.colorWithAlpha(n,r)),s.rect(a.x,a.y,a.width,a.height)};let f=[];const b=()=>{s.frameCount%120==1&&(()=>{const{topLeft:e,bottomRight:a}=d.logicalRegion,{width:n,height:r}=d.logicalSize,o=.1*n,i=.1*r,h=.7*n,c=.7*r;for(let n=0;n<4;n+=1){const n=t.Random.between(e.x,a.x-h),i=0,c=t.Random.Curved.between(t.Numeric.square,o,h),s=r;f.push(l(n,i,c,s,1))}for(let r=0;r<3;r+=1){const r=0,o=t.Random.between(e.y,a.y-c),h=n,s=t.Random.Curved.between(t.Numeric.square,i,c);f.push(l(r,o,h,s,0))}})(),f=f.filter(g)},w=()=>{s.blendMode(s.REPLACE),s.background(255),s.blendMode(s.MULTIPLY),f.forEach(p)},y={keyTyped:()=>{switch(s.key){case"p":e.pauseOrResume();break;case"g":s.save("image.png")}return!1},draw:()=>{b(),d.drawScaled(w)}};e.startSketch({htmlElement:"Layers",logicalCanvasHeight:1080,initialize:()=>{s.noStroke()},windowResized:()=>d.resizeIfNeeded(),onCanvasResized:()=>{},p5Methods:y})}(p5ex,CreativeCodingCore,chroma);