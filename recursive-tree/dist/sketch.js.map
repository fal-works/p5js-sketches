{"version":3,"file":"sketch.js","sources":["../src/settings.ts","../src/common.ts","../src/element.ts","../src/sketch.ts","../src/main.ts"],"sourcesContent":["/**\n * ---- Settings --------------------------------------------------------------\n */\n\n/** The id of the HTML element to which the canvas should belong. */\nexport const HTML_ELEMENT_ID = \"RecursiveTree\";\n","/**\n * ---- Common ----------------------------------------------------------------\n */\n\nimport p5 from \"p5\";\nimport * as Settings from \"./settings\";\n\nexport let container: HTMLElement;\n\nexport let p: p5;\n\nexport const initialize = (p5Instance: p5) => {\n  container =\n    document.getElementById(Settings.HTML_ELEMENT_ID) || document.body;\n  p = p5Instance;\n};\n","/**\n * ---- Element ---------------------------------------------------------------\n */\n\nimport p5 from \"p5\";\nimport { p } from \"./common\";\n\nconst randomColor = (): string => {\n  // p.colorMode(p.HSB, 1, 1, 1, 1);\n  // const hue = (0.001 * p.frameCount + 0.3 * Math.random()) % 1;\n  // const color = p.color(hue, 0.7, 0.95);\n  // const r = p.hex(Math.floor(p.red(color)), 2);\n  // const g = p.hex(Math.floor(p.green(color)), 2);\n  // const b = p.hex(Math.floor(p.blue(color)), 2);\n  // const colorCode = `#${r}${g}${b}`;\n  // return colorCode;\n\n  return \"#\" + p.random([\"ffcfdf\", \"fefdca\", \"e0f9b5\", \"a5dee5\"]);\n};\n\nexport interface Element {\n  mainDiv: p5.Element;\n  childrenDiv: p5.Element;\n  level: number;\n  children: Element[];\n  phase: number;\n}\n\nconst indentWidth = 64;\n\nexport const createElement = (parent?: Element, level = 0): Element => {\n  const mainDiv = p.createDiv();\n  mainDiv.style(`background-color: ${randomColor()}`);\n  mainDiv.addClass(\"line\");\n  mainDiv.addClass(\"new-line\");\n  mainDiv.addClass(\"item\");\n  const childrenDiv = p.createDiv();\n  childrenDiv.style(`margin-left: ${indentWidth}px`);\n  childrenDiv.addClass(\"item\");\n  if (parent) {\n    parent.mainDiv.child(mainDiv);\n    parent.mainDiv.child(childrenDiv);\n  }\n  const newElement: Element = {\n    mainDiv,\n    level,\n    children: [],\n    childrenDiv,\n    phase: 0,\n  };\n  setTimeout(() => {\n    mainDiv.removeClass(\"new-line\");\n    mainDiv.addClass(\"alive-line\");\n    newElement.phase = 1;\n    setTimeout(() => {\n      newElement.phase = 2;\n    }, 1000);\n  }, 1);\n  return newElement;\n};\n\nconst addChild = (_this: Element): void => {\n  const born = createElement(_this, _this.level + 1);\n  _this.children.push(born);\n  _this.childrenDiv.child(born.mainDiv);\n  _this.childrenDiv.child(born.childrenDiv);\n};\n\nconst remove = (_this: Element): void => {\n  _this.phase = 3;\n  _this.mainDiv.removeClass(\"alive-line\");\n  _this.mainDiv.addClass(\"dead-line\");\n  setTimeout(() => {\n    _this.mainDiv.remove();\n    _this.childrenDiv.remove();\n  }, 1000);\n  for (const child of _this.children) remove(child);\n};\n\nconst popRandomChild = (_this: Element): Element | undefined => {\n  const { children } = _this;\n  if (children.length === 0) return undefined;\n  const deadIndex = Math.floor(Math.random() * children.length);\n  const dead = children.splice(deadIndex, 1)[0];\n  if (dead.phase === 3) return undefined;\n  else return dead;\n};\n\nexport const updateElement = (_this: Element): void => {\n  if (_this.children.length < 2 && Math.random() < 0.03) addChild(_this);\n  else if (1 < _this.children.length && Math.random() < 0.005) {\n    const dead = popRandomChild(_this);\n    if (dead) remove(dead);\n  } else if (_this.level < 2)\n    for (const child of _this.children) updateElement(child);\n};\n","/**\n * ---- Sketch ----------------------------------------------------------------\n */\n\nimport { container, p } from \"./common\";\nimport { Element, createElement, updateElement } from \"./element\";\n\n// ---- variables & functions ----\nlet rootElement: Element;\n\n// ---- setup & draw ----\nexport const setup = (): void => {\n  p.noCanvas();\n\n  const wrapper = p.createDiv();\n  wrapper.style(\"margin: 10px\");\n  if (container) container.appendChild(wrapper.elt); // null check for OpenProcessing\n\n  rootElement = createElement();\n  const rootP5Element = rootElement;\n  wrapper.child(rootP5Element.mainDiv);\n  wrapper.child(rootP5Element.childrenDiv);\n};\n\nexport const draw = () => {\n  updateElement(rootElement);\n};\n","/**\n * ---- Main ------------------------------------------------------------------\n */\n\nimport p5 from \"p5\";\nimport * as sketch from \"./sketch\";\nimport * as common from \"./common\";\n\n// ---- start sketch ----\n\nnew p5((p: p5) => {\n  common.initialize(p);\n  p.setup = sketch.setup;\n  p.draw = sketch.draw;\n}, common.container);\n"],"names":["Settings.HTML_ELEMENT_ID","p5","common.initialize","sketch.setup","sketch.draw","common.container"],"mappings":"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"}